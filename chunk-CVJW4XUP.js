import{b as R,c as k}from"./chunk-2WW22MLQ.js";import"./chunk-VZSSPM6Z.js";import{a as y,b as h,c as D,f as v,g as x}from"./chunk-4TPATSYR.js";import"./chunk-6K3Y7BDI.js";import"./chunk-EYALUUED.js";import{Ab as u,Hb as p,Oa as c,Wb as e,X as f,Yb as d,Za as g,bb as m,ma as s,wb as t,xb as n,zb as C}from"./chunk-WWHZWTZN.js";import"./chunk-2NFLSA4Y.js";var M=class i{vcr=f(g);leakyCount=s(0);cleanCount=s(0);leakyRef=null;cleanRef=null;createWithoutCleanup(){this.leakyRef&&this.leakyRef.destroy(),this.leakyRef=this.vcr.createComponent(r),this.leakyCount.update(a=>a+1)}createWithCleanup(){this.cleanRef&&(this.cleanRef.destroy(),this.cleanRef=null),this.cleanRef=this.vcr.createComponent(r),this.cleanCount.update(a=>a+1)}ngOnDestroy(){console.log("\u{1F5D1}\uFE0F DanglingRefsComponent destroyed"),this.leakyRef&&this.leakyRef.destroy(),this.cleanRef&&(this.cleanRef.destroy(),this.cleanRef=null)}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=m({type:i,selectors:[["app-dangling-refs-section"]],decls:21,vars:2,consts:[[1,"example-section"],["mat-raised-button","",3,"click"],[1,"log"],["mat-raised-button","","color","primary",3,"click"]],template:function(o,l){o&1&&(t(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),e(3,"TODO something wrong with this Dangling Component References"),n()(),t(4,"mat-card-content")(5,"p"),e(6," Even when you destroy a component, keeping the reference prevents garbage collection. Always set references to null after destruction. Open DevTools profiler. "),n(),t(7,"div",0)(8,"h3"),e(9,"\u274C Memory Leak Example"),n(),t(10,"button",1),p("click",function(){return l.createWithoutCleanup()}),e(11," Create Component (Ref Not Cleared) "),n(),t(12,"div",2),e(13),n()(),t(14,"div",0)(15,"h3"),e(16,"\u2713 Correct Example"),n(),t(17,"button",3),p("click",function(){return l.createWithCleanup()}),e(18," Create Component (Ref Cleared) "),n(),t(19,"div",2),e(20),n()()()()),o&2&&(c(13),d("Components created: ",l.leakyCount()),c(7),d("Components created: ",l.cleanCount()))},dependencies:[x,y,D,v,h,k,R],styles:[".example-section[_ngcontent-%COMP%]{margin:16px 0;padding:12px;background-color:#f9f9f9;border-radius:4px}.example-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 12px;font-size:14px;font-weight:600}.example-section[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-right:8px;margin-bottom:8px}.log[_ngcontent-%COMP%]{margin:8px 0 0;padding:8px;background-color:#fff;border-left:3px solid #2196f3;font-family:monospace;font-size:12px;color:#333}"],changeDetection:0})},r=class i{heavyPayload;constructor(){this.heavyPayload=new Array(2e5).fill("heavy-chunk").join("|")}ngOnInit(){console.log("DynamicChildComponent mounted, heavy payload bytes:",this.heavyPayload.length)}ngOnDestroy(){console.log("DynamicChildComponent destroyed, clearing heavy payload"),this.heavyPayload=""}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=m({type:i,selectors:[["app-dynamic-child"]],decls:2,vars:0,template:function(o,l){o&1&&(C(0,"div"),e(1,"Dynamic Component"),u())},encapsulation:2})};export{M as DanglingRefsComponent};
